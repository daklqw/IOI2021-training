## TF
应该不难，然后我做了这么久……

难道我最近太划了？

~~显然分类讨论就做完了~~

考虑 $A$，$B$ 中间没有其他数，那么我们把这种连边记为 $A$。

显然对于每种 $A$ 只能选一个位置。

我们记每个位置 $i$ 如果 $v_i$ 只出现一遍，那么它是 $1$，否则是 $0$。

对于 $0$ 周围最多只能建一条边。

那么问题变成了一张奇怪的图的最大独立集。

看起来有很多团，但是因为值的连续性，直接 $f[i][j]$ 记为目前是第 $i$ 种边，上一个选的边位置在 $j$ 即可。
